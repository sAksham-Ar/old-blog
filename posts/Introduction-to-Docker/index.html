<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Introduction to Docker" /><meta property="og:locale" content="en" /><meta name="description" content="I have been playing around with Docker during the last few days ,and I am quite impressed by its abilities. I am writing this blog to share what I have learnt by trying to dockerize a simple Flask app." /><meta property="og:description" content="I have been playing around with Docker during the last few days ,and I am quite impressed by its abilities. I am writing this blog to share what I have learnt by trying to dockerize a simple Flask app." /><link rel="canonical" href="https://sakshamar.in/posts/Introduction-to-Docker/" /><meta property="og:url" content="https://sakshamar.in/posts/Introduction-to-Docker/" /><meta property="og:site_name" content="sAksham-Ar" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-29T00:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Introduction to Docker" /><meta name="twitter:site" content="@sakshamrocks123" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"I have been playing around with Docker during the last few days ,and I am quite impressed by its abilities. I am writing this blog to share what I have learnt by trying to dockerize a simple Flask app.","headline":"Introduction to Docker","dateModified":"2021-09-30T01:42:38+05:30","url":"https://sakshamar.in/posts/Introduction-to-Docker/","datePublished":"2021-09-29T00:00:00+05:30","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://sakshamar.in/posts/Introduction-to-Docker/"},"@context":"https://schema.org"}</script><title>Introduction to Docker | sAksham-Ar</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="sAksham-Ar"><meta name="application-name" content="sAksham-Ar"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/saksham.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">sAksham-Ar</a></div><div class="site-subtitle font-italic">Programming Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/sAksham-Ar" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/sakshamrocks123" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['aryasaksham','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Introduction to Docker</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Introduction to Docker</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Saksham Arya </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="2021-09-29 00:00:00 +0530" >2021-09-29 00:00:00 +0530<i class="unloaded">2021-09-29T00:00:00+05:30</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="2021-09-30 01:42:38 +0530 " >2021-09-30 01:42:38 +0530 <i class="unloaded">2021-09-30T01:42:38+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1065 ">5 </span></div></div><div class="post-content"><p>I have been playing around with Docker during the last few days ,and I am quite impressed by its abilities. I am writing this blog to share what I have learnt by trying to dockerize a simple Flask app.</p><h2 id="what-is-docker">What is Docker?</h2><p>Docker is an open source containerizing platform, It enables developers package their applications into containers.</p><h2 id="what-is-a-container">What is a Container?</h2><p>According to <a href="https://cloud.google.com/learn/what-are-containers">Google</a>,</p><blockquote><p>Containers are lightweight packages of your application code together with dependencies such as specific versions of programming language runtimes and libraries required to run your software services.</p></blockquote><h2 id="what-are-the-advantages-of-docker">What are the advantages of Docker?</h2><p>The major advantage of using docker is that you do not need to setup your application again and again for different servers, you can just create a docker image once and then deploy it easily on other servers. It also helps when different applications require different versions dependencies as running them in separate containers prevents dependency conflict.</p><h2 id="building-the-application">Building the Application</h2><p>Let us take a simple Flask app and try to dockerize it.</p><p>Code of the app:</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" from flask import Flask import mysql.connector from mysql.connector import errorcode app = Flask(__name__) @app.route(&#39;/&#39;) def connect(): try: mydb = mysql.connector.connect( host=&quot;localhost&quot;, user=&quot;docker_user&quot;, password=&quot;Docker@123&quot;, database=&quot;docker&quot; ) return &quot;Connected&quot; except mysql.connector.Error as err: if err.errno == errorcode.ER_ACCESS_DENIED_ERROR: return &quot;Something is wrong with your user name or password&quot; elif err.errno == errorcode.ER_BAD_DB_ERROR: return &quot;Database does not exist&quot; else: return str(err) if __name__ == &#39;__main__&#39;: app.run(debug=True) "></button></div><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">from</span> <span class="nn">mysql.connector</span> <span class="kn">import</span> <span class="n">errorcode</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mydb</span> <span class="o">=</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="s">"localhost"</span><span class="p">,</span>
            <span class="n">user</span><span class="o">=</span><span class="s">"docker_user"</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s">"Docker@123"</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="s">"docker"</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s">"Connected"</span>
    <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="p">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"Something is wrong with your user name or password"</span>
        <span class="k">elif</span> <span class="n">err</span><span class="p">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="p">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"Database does not exist"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</pre></table></code></div></div><p>Requirements of the app:</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" mysql-connector-python flask "></button></div><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
mysql-connector-python
flask

</pre></table></code></div></div><p>The app just tries to connect to MySQL as user <code class="language-plaintext highlighter-rouge">docker_user</code> to access database <code class="language-plaintext highlighter-rouge">docker</code> and returns <code class="language-plaintext highlighter-rouge">Connected</code> if the connection is successful.</p><p>Now we need to create this user and database in MySQL. Start the MySQL client and run the following commands,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" CREATE DATABASE docker; CREATE USER docker_user@&#39;localhost&#39; identified by &#39;Docker@123&#39;; GRANT ALL PRIVILEGES ON docker.* TO docker_user; FLUSH PRIVILEGES; "></button></div><div class="language-sql highlighter-rouge"><div class="code-header"> <span text-data=" Sql "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">docker</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">USER</span> <span class="n">docker_user</span><span class="o">@</span><span class="s1">'localhost'</span> <span class="n">identified</span> <span class="k">by</span> <span class="s1">'Docker@123'</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">docker</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="n">docker_user</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>

</pre></table></code></div></div><p>This first creates the database <code class="language-plaintext highlighter-rouge">docker</code>, then it creates the user <code class="language-plaintext highlighter-rouge">docker_user</code> and then grants privileges of the database <code class="language-plaintext highlighter-rouge">docker</code> to <code class="language-plaintext highlighter-rouge">docker_user</code>.</p><p>Now after running the app and visiting it in the browser we see,</p><p><img data-proofer-ignore data-src="/assets/docker-output-1.png" alt="app output" /></p><h2 id="dockerizing-the-application">Dockerizing the Application</h2><p>To create an image from the application, we would need to write a Dockerfile. The Dockerfile for this application is,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" # syntax=docker/dockerfile:1 FROM python:3.9-slim-buster WORKDIR /app COPY requirements.txt requirements.txt RUN pip install -r requirements.txt COPY . . ARG FLASK_PORT=5000 ENV FLASK_PORT=$FLASK_PORT ENTRYPOINT python3 -m flask run --host=0.0.0.0 --port=${FLASK_PORT} "></button></div><div class="language-Dockerfile highlighter-rouge"><div class="code-header"> <span text-data=" Dockerfile "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>
<span class="c"># syntax=docker/dockerfile:1</span>

<span class="k">FROM</span><span class="s"> python:3.9-slim-buster</span>
<span class="k">WORKDIR</span><span class="s"> /app</span>
<span class="k">COPY</span><span class="s"> requirements.txt requirements.txt</span>
<span class="k">RUN </span>pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
<span class="k">COPY</span><span class="s"> . .</span>
<span class="k">ARG</span><span class="s"> FLASK_PORT=5000</span>
<span class="k">ENV</span><span class="s"> FLASK_PORT=$FLASK_PORT</span>
<span class="k">ENTRYPOINT</span><span class="s"> python3 -m flask run --host=0.0.0.0 --port=${FLASK_PORT}</span>

</pre></table></code></div></div><p>Here we are first taking a base image of python3.9 which already has python and pip installed, then we are a creating a working directory so that we can write relative paths. We then copy our <code class="language-plaintext highlighter-rouge">requirements.txt</code> to our working directory and install the packages needed. Finally, we copy our code, taking <code class="language-plaintext highlighter-rouge">port</code> as an environment variable, and run the app.</p><p><strong>Note: it is important to run the flask app on <code class="language-plaintext highlighter-rouge">0.0.0.0</code> else we will note be able to forward it.</strong></p><p>Now, we can build the image using,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" docker build --tag flask-docker . "></button></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
docker build <span class="nt">--tag</span> flask-docker <span class="nb">.</span>

</pre></table></code></div></div><p>Now using <code class="language-plaintext highlighter-rouge">docker images</code> we can see that our image has been built,</p><p><img data-proofer-ignore data-src="/assets/docker-images.png" alt="docker images output" /></p><p>Now for MySQL, there is already an official image on <a href="https://hub.docker.com/_/mysql">docker hub</a> (it is a website from where docker gets images uploaded by other people), we just need to pass our environment variables,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" docker run --name db -e MYSQL_ROOT_PASSWORD=&quot;Docker@123&quot; -e MYSQL_DATABASE=&quot;docker&quot; -e MYSQL_USER=&quot;docker_user&quot; -e MYSQL_PASSWORD=&quot;Docker@123&quot; -d mysql "></button></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
docker run <span class="nt">--name</span> db <span class="nt">-e</span> <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span><span class="s2">"Docker@123"</span> <span class="nt">-e</span> <span class="nv">MYSQL_DATABASE</span><span class="o">=</span><span class="s2">"docker"</span> <span class="nt">-e</span> <span class="nv">MYSQL_USER</span><span class="o">=</span><span class="s2">"docker_user"</span> <span class="nt">-e</span> <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span><span class="s2">"Docker@123"</span> <span class="nt">-d</span> mysql

</pre></table></code></div></div><p>Here <code class="language-plaintext highlighter-rouge">-d</code> is for running in detached mode, by default docker is attached to the terminal so when we close it our application will also close.</p><p>Now, let’s run our app on port <code class="language-plaintext highlighter-rouge">5000</code>,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" docker run --name app -e FLASK_PORT=&quot;5000&quot; -p 5000:5000 -d flask-docker "></button></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
docker run <span class="nt">--name</span> app <span class="nt">-e</span> <span class="nv">FLASK_PORT</span><span class="o">=</span><span class="s2">"5000"</span> <span class="nt">-p</span> 5000:5000 <span class="nt">-d</span> flask-docker

</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">-p</code> flag maps the port <code class="language-plaintext highlighter-rouge">5000</code> of our pc to <code class="language-plaintext highlighter-rouge">5000</code> of the Docker conatiner.</p><p><img data-proofer-ignore data-src="/assets/docker-output-without-network.png" alt="app output without link" /></p><h2 id="networks">Networks</h2><p>As we can see our app cannot reach the database even though the database is running this is because they are running in separate containers. With Docker, we can add them both in the same network.</p><p>First let us create a network,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" docker network create my_network "></button></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
docker network create my_network

</pre></table></code></div></div><p>Then, changing the host in our app.py to name of the MySQL container <code class="language-plaintext highlighter-rouge">db</code> and rebuilding the image,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" from flask import Flask import mysql.connector from mysql.connector import errorcode app = Flask(__name__) @app.route(&#39;/&#39;) def connect(): try: mydb = mysql.connector.connect( host=&quot;db&quot;, user=&quot;docker_user&quot;, password=&quot;Docker@123&quot;, database=&quot;docker&quot; ) return &quot;Connected&quot; except mysql.connector.Error as err: if err.errno == errorcode.ER_ACCESS_DENIED_ERROR: return &quot;Something is wrong with your user name or password&quot; elif err.errno == errorcode.ER_BAD_DB_ERROR: return &quot;Database does not exist&quot; else: return str(err) if __name__ == &#39;__main__&#39;: app.run(debug=True) "></button></div><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">from</span> <span class="nn">mysql.connector</span> <span class="kn">import</span> <span class="n">errorcode</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mydb</span> <span class="o">=</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="s">"db"</span><span class="p">,</span>
            <span class="n">user</span><span class="o">=</span><span class="s">"docker_user"</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s">"Docker@123"</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="s">"docker"</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s">"Connected"</span>
    <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="p">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"Something is wrong with your user name or password"</span>
        <span class="k">elif</span> <span class="n">err</span><span class="p">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="p">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"Database does not exist"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</pre></table></code></div></div><p>Finally, we rerun our db and app with this network,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" docker run --name db -e MYSQL_ROOT_PASSWORD=&quot;Docker@123&quot; -e MYSQL_DATABASE=&quot;docker&quot; -e MYSQL_USER=&quot;docker_user&quot; -e MYSQL_PASSWORD=&quot;Docker@123&quot; -d --network my_network mysql docker run --name app -e FLASK_PORT=&quot;5000&quot; -p 5000:5000 -d --network my_network flask-docker "></button></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
 docker run <span class="nt">--name</span> db <span class="nt">-e</span> <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span><span class="s2">"Docker@123"</span> <span class="nt">-e</span> <span class="nv">MYSQL_DATABASE</span><span class="o">=</span><span class="s2">"docker"</span> <span class="nt">-e</span> <span class="nv">MYSQL_USER</span><span class="o">=</span><span class="s2">"docker_user"</span> <span class="nt">-e</span> <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span><span class="s2">"Docker@123"</span> <span class="nt">-d</span>  <span class="nt">--network</span> my_network mysql
 docker run <span class="nt">--name</span> app <span class="nt">-e</span> <span class="nv">FLASK_PORT</span><span class="o">=</span><span class="s2">"5000"</span> <span class="nt">-p</span> 5000:5000 <span class="nt">-d</span> <span class="nt">--network</span> my_network flask-docker

</pre></table></code></div></div><p>Now going to <code class="language-plaintext highlighter-rouge">http://localhost:5000/</code>,</p><p><img data-proofer-ignore data-src="/assets/docker-final-output.png" alt="final output" /></p><h2 id="docker-compose">Docker-compose</h2><p>As you can probably see that the commands we have to run have become very long, and we need to rerun then every time we change our image or our configuration. The solution to this is <code class="language-plaintext highlighter-rouge">docker-compose</code>, we just need to create a <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> file. For our current setup:</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" version: &quot;3.9&quot; services: app: image: flask-docker ports: - &quot;5000:5000&quot; environment: - FLASK_PORT=5000 db: image: mysql ports: - &quot;3306:3306&quot; environment: - MYSQL_ROOT_PASSWORD=Docker@123 - MYSQL_DATABASE=docker - MYSQL_USER=docker_user - MYSQL_PASSWORD=Docker@123 "></button></div><div class="language-yml highlighter-rouge"><div class="code-header"> <span text-data=" YAML "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>
<span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3.9"</span>
<span class="na">services</span><span class="pi">:</span> 
  <span class="na">app</span><span class="pi">:</span> 
    <span class="na">image</span><span class="pi">:</span> <span class="s">flask-docker</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5000:5000"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">FLASK_PORT=5000</span>
  
  <span class="na">db</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mysql</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">3306:3306"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MYSQL_ROOT_PASSWORD=Docker@123</span>
      <span class="pi">-</span> <span class="s">MYSQL_DATABASE=docker</span>
      <span class="pi">-</span> <span class="s">MYSQL_USER=docker_user</span>
      <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=Docker@123</span>

</pre></table></code></div></div><p><strong>Note: Different versions of docker-compose has different syntax see <a href="https://docs.docker.com/compose/compose-file/compose-versioning/">here</a>.</strong></p><p>Now to run our setup we just need to run,</p><div class="copy-code-container"> <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code=" docker-compose up -d "></button></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
docker-compose up <span class="nt">-d</span>

</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">docker-compose</code> already creates a default network, so we do not need to create another.</p><h2 id="conclusion">Conclusion</h2><p>Now we have reduced our setup to a single command after installing <code class="language-plaintext highlighter-rouge">docker</code> and <code class="language-plaintext highlighter-rouge">docker-compose</code>.</p><p>By default, data stored in Docker is written in the writable container layer which no longer exists after the container is destroyed, and it is also difficult to move. For persistent data you should use <a href="https://docs.docker.com/storage/volumes/">volumes</a>.</p><p>You are encouraged to learn more about docker at the <a href="https://docs.docker.com">official docs</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/development/'>Development</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1"></span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Introduction to Docker - sAksham-Ar&url=https://sakshamar.in/posts/Introduction-to-Docker/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Introduction to Docker - sAksham-Ar&u=https://sakshamar.in/posts/Introduction-to-Docker/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Introduction to Docker - sAksham-Ar&url=https://sakshamar.in/posts/Introduction-to-Docker/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="" title-succeed=""> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Introduction-to-Docker/">Introduction to Docker</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Using-Selenium-in-Python/"><div class="card-body"> <span class="timeago small" >Apr 29<i class="unloaded">2021-04-29T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using Selenium in Python</h3><div class="text-muted small"><p> Today we are going to learn how to automate your browser using Selenium in Python.Today we will go to Youtube search something and store the results as JSON.Scraping Youtube results is not possible...</p></div></div></a></div><div class="card"> <a href="/posts/Web-scraping-in-python/"><div class="card-body"> <span class="timeago small" >Apr 16<i class="unloaded">2021-04-16T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Web scraping in Python</h3><div class="text-muted small"><p> Today we are going to learn how to scrape a website in python. We will be scraping google to find results and store them as JSON. Requirements For web scraping we would require two libraries: ...</p></div></div></a></div><div class="card"> <a href="/posts/Linked-lists/"><div class="card-body"> <span class="timeago small" >Jul 27, 2020<i class="unloaded">2020-07-27T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linked lists</h3><div class="text-muted small"><p> In link list a structure is declared as head and it has a next pointer which points to next item in the list and similarly all items have a next pointer.The next pointer of the last element points ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Using-Selenium-in-Python/" class="btn btn-outline-primary" prompt="Older"><p>Using Selenium in Python</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><script src="/assets/scripts/copyCode.js"></script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/sakshamrocks123">Saksham Arya</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
